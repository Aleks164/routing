import _asyncToGenerator from"@babel/runtime/helpers/asyncToGenerator";import _regeneratorRuntime from"@babel/runtime/regenerator";import{getLocaion}from"./geo";function Router(){var e=[],n=location.pathname,t=null,r=null,o=function(e,n){return e instanceof RegExp&&e.test(n)||"function"==typeof e&&e(n)||"string"==typeof e&&e===n},a=function(e){var a=e.match,c=e.onEnter,u=e.onLeave,i=e.onBeforeEnter;console.log("1");var s={currentPath:n,previousPath:t,state:history.state};o(a,n)&&c(s),u&&o(a,t)&&u(),i&&o(a,r)&&i(),console.log("onLeave","isMatch(match, previousPath)",o(a,t))},c=function(){return e.forEach(a)};return window.addEventListener("popstate",c),{on:function(n,t,r,o){var c=function(){for(var n=function(){return Math.floor(Math.random()*e.length*1e3)},t=function(n){return e.find((function(e){return e.id===n}))},r=n();t(r);)r=n();return r}(),u={id:c,match:n,onEnter:t,onLeave:r,onBeforeEnter:o};return e.push(u),a(u),function(){console.log("removed"),console.log("before",e),e=e.filter((function(e){return e.id!==c})),console.log("after",e),console.log("id",c)}},go:function(e,o){r=e,t=n,history.pushState(o,e,e),n=location.pathname,c(),console.log("url",e,"currentPath",n)}}}var createRender=function(e){return _asyncToGenerator(_regeneratorRuntime.mark((function n(){var t;return _regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("3",e),n.next=3,getLocaion();case 3:t=n.sent,document.getElementById("root").innerHTML="<h2>".concat(JSON.stringify(t),"</h2>");case 5:case"end":return n.stop()}}),n)})))},createAsincRender=function(e){return _asyncToGenerator(_regeneratorRuntime.mark((function n(){return _regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:document.getElementById("root").innerHTML="<h2>on ".concat(e," location is </h2>");case 1:case"end":return n.stop()}}),n)})))},router=Router(),unsubscribe=router.on(/.*/,createAsincRender("/.*"));router.on((function(e){return"/contacts"===e}),createRender("/contacts"),createAsincRender("[leaving] /contacts")),router.on("/about",createAsincRender("/about"),createAsincRender("/about"),createAsincRender("/about")),router.on("/about/us",createAsincRender("/about/us")),document.body.addEventListener("click",(function(e){if(e.target.matches("a")){e.preventDefault();var n=e.target.getAttribute("href"),t=Math.random();router.go(n,t),unsubscribe()}}));